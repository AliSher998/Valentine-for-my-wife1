<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Love Story ‚ù§Ô∏è</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/CustomEase.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Pinyon+Script&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        /* --- HIGH-END CUSTOM CSS --- */
        :root {
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-bg: rgba(20, 20, 20, 0.6);
            --neon-glow: 0 0 20px rgba(255, 0, 60, 0.6);
        }

        body {
            background-color: #050505;
            color: #fff;
            overflow: hidden;
            font-family: 'Playfair Display', serif;
            touch-action: none; /* Prevents scroll bounce on mobile */
        }

        /* Animated Gradient Background */
        .ambient-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 50%, #2a0a12 0%, #000000 100%);
            z-index: -2;
        }

        /* Starfield Canvas */
        #starCanvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.8;
        }

        /* 3D Card Effect */
        .tilt-card {
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
        }

        /* Text Gradients */
        .gold-text {
            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(191, 149, 63, 0.3);
        }

        /* Envelope Styles */
        .envelope-wrapper {
            perspective: 1000px;
        }
        .envelope {
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .envelope.open {
            transform: rotateX(180deg);
            opacity: 0;
        }

        /* Gallery Scroll */
        .gallery-track {
            display: flex;
            gap: 20px;
            padding: 20px;
            overflow-x: auto;
            scroll-behavior: smooth;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .gallery-track::-webkit-scrollbar { display: none; }
        
        .gallery-item {
            min-width: 280px;
            height: 350px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .gallery-item img {
            width: 100%; height: 100%; object-fit: cover;
        }

        /* Music Pulse */
        .music-pulse {
            animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }
    </style>
</head>
<body>

    <div class="ambient-bg"></div>
    <canvas id="starCanvas"></canvas>

    <div class="fixed top-6 right-6 z-50">
        <button id="musicToggle" class="w-12 h-12 rounded-full glass-panel flex items-center justify-center text-white transition-all duration-300">
            <span id="musicIcon" class="text-xl">üîá</span>
        </button>
    </div>
    <audio id="bgMusic" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/10/25/audio_2901379374.mp3?filename=romantic-piano-123456.mp3" type="audio/mpeg">
    </audio>

    <div id="scene-intro" class="fixed inset-0 flex flex-col items-center justify-center z-40">
        <div class="envelope-wrapper cursor-pointer" id="envelopeBtn">
            <div class="w-64 h-48 bg-red-900 rounded-lg shadow-2xl relative flex items-center justify-center border-2 border-red-800 envelope">
                <div class="absolute inset-0 border-4 border-double border-yellow-600 rounded-lg opacity-30"></div>
                <div class="text-center">
                    <p class="font-['Cinzel'] text-yellow-500 text-xs tracking-[0.2em] mb-2">FOR MY WIFE</p>
                    <div class="w-16 h-16 bg-red-800 rounded-full flex items-center justify-center mx-auto border border-yellow-600 shadow-inner">
                        <span class="text-2xl">‚ù§Ô∏è</span>
                    </div>
                    <p class="font-['Pinyon_Script'] text-white text-xl mt-2 animate-pulse">Tap to Open</p>
                </div>
            </div>
        </div>
    </div>

    <div id="scene-question" class="fixed inset-0 flex items-center justify-center z-30 hidden opacity-0">
        <div class="glass-panel w-[90%] max-w-md rounded-[40px] p-8 text-center tilt-card relative overflow-hidden">
            <div class="absolute top-0 left-1/2 -translate-x-1/2 w-32 h-32 bg-red-600 rounded-full blur-[60px] opacity-40"></div>
            
            <div class="relative z-10">
                <div class="mb-6 rounded-2xl overflow-hidden shadow-2xl border border-white/10">
                    <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHp1eXF5MHF4eHJ4eHJ4eHJ4eHJ4eHJ4eHJ4eHJ4eHJ4eHJ4eHJ4JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1n/c76IJLufpNwSULPk77/giphy.gif" 
                         alt="Cute Gif" class="w-full h-48 object-cover">
                </div>

                <h1 class="font-['Pinyon_Script'] text-5xl text-white mb-2 leading-tight">My Love</h1>
                <p class="font-['Playfair_Display'] text-gray-300 mb-8 italic text-lg leading-relaxed">
                    "In a world full of chaos,<br>you are my only peace."
                </p>
                
                <p class="font-['Cinzel'] text-sm tracking-widest text-red-400 mb-6">WILL YOU BE MY VALENTINE?</p>

                <div class="flex flex-col gap-4 items-center justify-center min-h-[140px] relative">
                    <button id="yesBtn" class="bg-gradient-to-r from-red-600 to-pink-600 text-white font-bold py-4 px-12 rounded-full shadow-[0_0_20px_rgba(255,0,60,0.5)] text-lg tracking-wider transition-transform active:scale-95 z-20">
                        YES, FOREVER
                    </button>
                    
                    <button id="noBtn" class="bg-white/10 text-gray-400 font-medium py-3 px-8 rounded-full border border-white/20 text-sm backdrop-blur-md transition-all z-10">
                        No, thanks
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="scene-gallery" class="fixed inset-0 z-20 hidden opacity-0 bg-black/80 backdrop-blur-xl overflow-y-auto">
        <div class="min-h-screen p-6 flex flex-col items-center pt-20">
            <h1 class="font-['Pinyon_Script'] gold-text text-6xl mb-4 text-center">She Said Yes!</h1>
            <p class="font-['Playfair_Display'] text-white/80 text-center mb-10 max-w-sm italic">
                You just made me the happiest person in the entire universe.
            </p>

            <div class="w-full max-w-lg">
                <div class="gallery-track snap-x">
                    <div class="gallery-item snap-center flex-shrink-0 bg-gray-800">
                        <img src="https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=1000&auto=format&fit=crop" alt="Memory 1">
                        <div class="absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black to-transparent">
                            <p class="text-white font-['Cinzel'] text-xs">OUR FIRST DATE</p>
                        </div>
                    </div>
                    <div class="gallery-item snap-center flex-shrink-0 bg-gray-800">
                        <img src="https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?q=80&w=1000&auto=format&fit=crop" alt="Memory 2">
                        <div class="absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black to-transparent">
                            <p class="text-white font-['Cinzel'] text-xs">THAT TRIP WE TOOK</p>
                        </div>
                    </div>
                    <div class="gallery-item snap-center flex-shrink-0 bg-gray-800">
                        <img src="https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?q=80&w=1000&auto=format&fit=crop" alt="Memory 3">
                        <div class="absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black to-transparent">
                            <p class="text-white font-['Cinzel'] text-xs">JUST US</p>
                        </div>
                    </div>
                </div>
                <p class="text-center text-white/40 text-xs mt-4 animate-pulse">Swipe to see memories &rarr;</p>
            </div>

            <div class="mt-12 mb-10 text-center">
                <p class="font-['Cinzel'] text-2xl mb-2 text-red-500">I LOVE YOU</p>
                <p class="text-sm text-gray-500">Always & Forever</p>
            </div>
        </div>
    </div>

    <script>
        // --- 1. SETUP & UTILS ---
        gsap.registerPlugin(CustomEase);
        const music = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        let isMusicPlaying = false;

        // --- 2. AUDIO CONTROL ---
        musicBtn.addEventListener('click', () => {
            if (isMusicPlaying) {
                music.pause();
                musicBtn.classList.remove('music-pulse');
                document.getElementById('musicIcon').innerText = 'üîá';
            } else {
                music.play();
                musicBtn.classList.add('music-pulse');
                document.getElementById('musicIcon').innerText = 'üéµ';
            }
            isMusicPlaying = !isMusicPlaying;
        });

        // --- 3. BACKGROUND PARTICLES (High Performance) ---
        const canvas = document.getElementById('starCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 2;
                this.speedX = Math.random() * 0.5 - 0.25;
                this.speedY = Math.random() * 0.5 - 0.25;
                this.alpha = Math.random();
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.alpha > 0) this.alpha -= 0.005;
                if (this.alpha <= 0) {
                    this.x = Math.random() * width;
                    this.y = Math.random() * height;
                    this.alpha = 1;
                }
            }
            draw() {
                ctx.fillStyle = `rgba(255, 100, 100, ${this.alpha})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        for (let i = 0; i < 80; i++) particles.push(new Particle());

        function animateBg() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animateBg);
        }
        animateBg();

        // --- 4. SCENE TRANSITIONS ---
        
        // Open Envelope
        document.getElementById('envelopeBtn').addEventListener('click', () => {
            // Animate envelope opening
            gsap.to('.envelope', { rotationX: 180, duration: 0.8, ease: 'back.in(1.7)' });
            gsap.to('#scene-intro', { opacity: 0, scale: 1.5, duration: 0.8, delay: 0.4, onComplete: () => {
                document.getElementById('scene-intro').style.display = 'none';
                document.getElementById('scene-question').style.display = 'flex';
                
                // Show Card with GSAP
                gsap.to('#scene-question', { opacity: 1, duration: 1 });
                gsap.from('.tilt-card', { y: 100, opacity: 0, duration: 1.2, ease: 'power3.out' });
                
                // Try to auto-play music (might be blocked by browser, but worth a try)
                music.volume = 0.5;
                music.play().then(() => {
                    isMusicPlaying = true;
                    musicBtn.classList.add('music-pulse');
                    document.getElementById('musicIcon').innerText = 'üéµ';
                }).catch(e => console.log("Auto-play prevented"));
            }});
        });

        // --- 5. THE "NO" BUTTON PHYSICS (MAGNETIC EVASION) ---
        const noBtn = document.getElementById('noBtn');
        const yesBtn = document.getElementById('yesBtn');
        const card = document.querySelector('.tilt-card');
        const btnContainer = noBtn.parentElement;

        // Function to move button away from pointer
        function evade(e) {
            const rect = noBtn.getBoundingClientRect();
            const containerRect = btnContainer.getBoundingClientRect();
            
            // Get pointer position (touch or mouse)
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;

            const btnCenterX = rect.left + rect.width / 2;
            const btnCenterY = rect.top + rect.height / 2;

            const dist = Math.hypot(clientX - btnCenterX, clientY - btnCenterY);

            // If closer than 100px, move away
            if (dist < 100) {
                const angle = Math.atan2(clientY - btnCenterY, clientX - btnCenterX);
                const moveDist = 80; // how far it jumps
                
                // Calculate new position relative to current
                let newX = Math.cos(angle + Math.PI) * moveDist;
                let newY = Math.sin(angle + Math.PI) * moveDist;

                gsap.to(noBtn, {
                    x: `+=${newX}`,
                    y: `+=${newY}`,
                    duration: 0.3,
                    ease: 'power2.out'
                });
                
                // Grow Yes Button
                gsap.to(yesBtn, { scale: '+=0.1', duration: 0.3 });
            }
        }

        document.addEventListener('mousemove', evade);
        document.addEventListener('touchmove', evade, { passive: false });
        noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); evade(e); });


        // --- 6. THE "YES" CELEBRATION ---
        yesBtn.addEventListener('click', () => {
            // 1. Hide Question
            gsap.to('#scene-question', { scale: 0.8, opacity: 0, duration: 0.5, onComplete: () => {
                 document.getElementById('scene-question').style.display = 'none';
                 document.getElementById('scene-gallery').style.display = 'block';
                 
                 // 2. Show Gallery
                 gsap.to('#scene-gallery', { opacity: 1, duration: 1 });
                 gsap.from('.gallery-item', { 
                     y: 50, 
                     opacity: 0, 
                     stagger: 0.2, 
                     duration: 1, 
                     ease: 'power3.out' 
                 });

                 // 3. Massive Confetti
                 const duration = 5000;
                 const end = Date.now() + duration;

                 (function frame() {
                    confetti({
                        particleCount: 5,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 },
                        colors: ['#ff0000', '#ffaaaa', '#ffeb3b']
                    });
                    confetti({
                        particleCount: 5,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 },
                        colors: ['#ff0000', '#ffaaaa', '#ffeb3b']
                    });

                    if (Date.now() < end) {
                        requestAnimationFrame(frame);
                    }
                 }());
            }});
        });

        // --- 7. 3D TILT EFFECT (For Mobile Accelerometer) ---
        window.addEventListener("deviceorientation", (event) => {
            const tiltX = event.beta;  // (-180 to 180)
            const tiltY = event.gamma; // (-90 to 90)
            
            // Limit tilt for subtle effect
            if (window.innerWidth < 768) {
                gsap.to('.tilt-card', {
                    rotationX: tiltX / 2, // Up/Down tilt
                    rotationY: tiltY / 2, // Left/Right tilt
                    duration: 0.5,
                    ease: 'power2.out'
                });
            }
        });
        
        // Mouse tilt for desktop testing
        document.addEventListener('mousemove', (e) => {
            if (window.innerWidth >= 768) {
                const x = (e.clientX / window.innerWidth - 0.5) * 20;
                const y = (e.clientY / window.innerHeight - 0.5) * 20;
                gsap.to('.tilt-card', {
                    rotationY: x,
                    rotationX: -y,
                    duration: 0.5
                });
            }
        });

    </script>
</body>
    </html>
    
